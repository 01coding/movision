<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.zhuhuibao.mybatis.vip.mapper.VipInfoMapper" >
  <resultMap id="VipMemberPrivilegeResultMap" type="com.zhuhuibao.mybatis.vip.entity.VipMemberPrivilege" >
  	<id column="id" property="id" jdbcType="BIGINT" />
    <result column="member_id" property="memberId" jdbcType="BIGINT" />
    <result column="type" property="type" jdbcType="VARCHAR" />
    <result column="pinyin" property="pinyin" jdbcType="VARCHAR" />
    <result column="name" property="name" jdbcType="VARCHAR" />
    <result column="value" property="value" jdbcType="VARCHAR" />
    <result column="description" property="description" jdbcType="VARCHAR" />
    <result column="add_time" property="addTime" jdbcType="TIMESTAMP" />
    <result column="update_time" property="updateTime" jdbcType="TIMESTAMP" />
  </resultMap>
  
  <select id="selectVipMemberPrivilege" parameterType="java.util.Map" resultMap="VipMemberPrivilegeResultMap">
  	SELECT 
	  id,member_id,type,pinyin,name,value,description,add_time,update_time 
	FROM
	  t_vip_member_privilege 
	WHERE member_id = #{memberId,jdbcType=BIGINT} 
	  AND pinyin = #{pinyin,jdbcType=VARCHAR}
  </select>
  
  <update id="updateVipMemberPrivilegeValue" parameterType="com.zhuhuibao.mybatis.vip.entity.VipMemberPrivilege">
  	UPDATE 
	  t_vip_member_privilege 
	SET
	  value = #{value,jdbcType=VARCHAR} ,
	  update_time = NOW() 
	WHERE member_id = #{memberId,jdbcType=BIGINT} 
	  AND pinyin = #{pinyin,jdbcType=VARCHAR} 
	  AND update_time = #{updateTime,jdbcType=TIMESTAMP}
  </update>
  
  
  
  
  
  
  
  
  
  

 <select id="selectZhbRecordByOrderNoAndType" parameterType="java.util.Map"  resultMap="ZhbRecordResultMap" >
 	SELECT 
	  id,order_no,buyer_id,operater_id,amount,STATUS,TYPE,goods_type,goods_id,description,add_time,update_time
	FROM
	  t_zhb_record 
	WHERE order_no = #{orderNo,jdbcType=VARCHAR}
	  AND TYPE = #{type,jdbcType=VARCHAR}
 </select>
 
 <select id="selectZhbRecordListByOrderNo" parameterType="java.lang.String"  resultMap="ZhbRecordResultMap" >
 	SELECT 
	  id,order_no,buyer_id,operater_id,amount,STATUS,TYPE,goods_type,goods_id,description,add_time,update_time
	FROM
	  t_zhb_record 
	WHERE order_no = #{orderNo,jdbcType=VARCHAR}
 </select>

 <insert id="insertZhbRecord" parameterType="com.zhuhuibao.mybatis.zhb.entity.ZhbRecord">
 	INSERT INTO t_zhb_record
 	<trim prefix="(" suffix=")" suffixOverrides="," >
 	  order_no,
	  buyer_id,
	  operater_id,
	  amount,
	  status,
	  type,
	  add_time,
	  update_time,
	  <if test="goods_type != null" >
        goods_type,
      </if>
      <if test="goods_id != null" >
        goods_id,
      </if>
      <if test="description != null" >
        description,
      </if>
 	</trim>
 	<trim prefix="values (" suffix=")" suffixOverrides="," >
	  #{orderNo,jdbcType=VARCHAR},
	  #{buyerId,jdbcType=BIGINT},
	  #{operaterId,jdbcType=BIGINT},
	  #{amount,jdbcType=DECIMAL},
	  #{status,jdbcType=VARCHAR},
	  #{type,jdbcType=VARCHAR},
	  now(),
	  now(),
	  <if test="goods_type != null" >
        #{goodsType,jdbcType=VARCHAR},
      </if>
      <if test="goods_id != null" >
        #{goodsId,jdbcType=VARCHAR},
      </if>
      <if test="description != null" >
        description,
        #{description,jdbcType=VARCHAR},
      </if>
 	</trim>
 </insert>
 
 <select id="selectZhbAccount" parameterType="java.lang.Long"  resultMap="ZhbAccountResultMap" >
 
 	SELECT 
	  id,member_id,STATUS,amount,add_time,update_time  
	FROM
	  t_zhb_account 
	WHERE member_id = #{memberId,jdbcType=BIGINT}
 </select>
 
 <insert id="insertZhbAccount" parameterType="com.zhuhuibao.mybatis.zhb.entity.ZhbAccount">
 	INSERT INTO t_zhb_account (
	  member_id,
	  status,
	  amount,
	  add_time,
	  update_time
	) 
	VALUES
	  (
	  #{memberId,jdbcType=BIGINT},
	  #{status,jdbcType=VARCHAR},
	  #{amount,jdbcType=VARCHAR},
	  now(),
	  now()
	  )
 </insert>
 
 <update id="updateZhbAccountEmoney" parameterType="com.zhuhuibao.mybatis.zhb.entity.ZhbAccount" >
 	UPDATE 
	  t_zhb_account 
	SET
	  status = #{status,jdbcType=VARCHAR},
	  amount = #{amount,jdbcType=VARCHAR}, 
	WHERE member_id = #{memberId,jdbcType=BIGINT}, 
	  AND update_time =#{updateTime,jdbcType=TIMESTAMP}
 </update>
 
 <select id="selectZhbGoodsConfigByPinyin" resultMap="ZhbGoodsConfigMap">
 	SELECT 
	  id,name,pinyin,type,value,price,add_time
	FROM
	  t_zhb_goods_config 
	WHERE pinyin = #{pinyin,jdbcType=VARCHAR}
 </select>
	
</mapper>